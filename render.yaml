services:
  - type: web
    name: event-planner-backend
    runtime: docker
    dockerfilePath: ./apps/backend/Dockerfile
    dockerContext: ./apps/backend
    env: production
    plan: free
    healthCheckPath: /
    envVars:
      - key: FLASK_APP
        value: app.py
      - key: FLASK_ENV
        value: production
      - key: PORT
        value: 5001
      - key: FLASK_SECRET_KEY
        generateValue: true
      # Using Supabase PostgreSQL (free, permanent, no 90-day expiration)
      # Get this from: Supabase Dashboard → Settings → Database → Connection Pooling → Transaction mode
      # Format: postgresql://postgres.xxxxxxxxxxxx:[PASSWORD]@aws-0-us-east-1.pooler.supabase.com:6543/postgres
      - key: DATABASE_URL
        sync: false
      - key: SENDGRID_API_KEY
        sync: false
      - key: SENDGRID_FROM_EMAIL
        sync: false
      - key: GROK_API_KEY
        sync: false
      # Update this after deploying frontend to Vercel
      - key: FRONTEND_URL
        value: http://localhost:3000
